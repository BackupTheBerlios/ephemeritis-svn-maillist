<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Ephemeritis-svn] r228 - in branches/new-vsop-prepare/src/c: tests utils
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/ephemeritis-svn/2006-January/index.html" >
   <LINK REL="made" HREF="mailto:ephemeritis-svn%40lists.berlios.de?Subject=Re%3A%20%5BEphemeritis-svn%5D%20r228%20-%20in%20branches/new-vsop-prepare/src/c%3A%20tests%20utils&In-Reply-To=%3C200601280212.k0S2CVr6029727%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000081.html">
   <LINK REL="Next"  HREF="000082.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Ephemeritis-svn] r228 - in branches/new-vsop-prepare/src/c: tests utils</H1>
    <B>izogi at BerliOS</B> 
    <A HREF="mailto:ephemeritis-svn%40lists.berlios.de?Subject=Re%3A%20%5BEphemeritis-svn%5D%20r228%20-%20in%20branches/new-vsop-prepare/src/c%3A%20tests%20utils&In-Reply-To=%3C200601280212.k0S2CVr6029727%40sheep.berlios.de%3E"
       TITLE="[Ephemeritis-svn] r228 - in branches/new-vsop-prepare/src/c: tests utils">izogi at berlios.de
       </A><BR>
    <I>Sat Jan 28 03:12:31 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000081.html">[Ephemeritis-svn] r227 - branches/new-vsop-prepare/src/c/libephemeritis
</A></li>
        <LI>Next message: <A HREF="000082.html">[Ephemeritis-svn] r229 - branches/new-vsop-prepare/src/c/libephemeritis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80">[ date ]</a>
              <a href="thread.html#80">[ thread ]</a>
              <a href="subject.html#80">[ subject ]</a>
              <a href="author.html#80">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: izogi
Date: 2006-01-28 03:12:11 +0100 (Sat, 28 Jan 2006)
New Revision: 228

Modified:
   branches/new-vsop-prepare/src/c/tests/validate_meeus.c
   branches/new-vsop-prepare/src/c/utils/build_vsop_data.c
Log:
Ran 'indent -kr' on utils/ and tests/ files.


Modified: branches/new-vsop-prepare/src/c/tests/validate_meeus.c
===================================================================
--- branches/new-vsop-prepare/src/c/tests/validate_meeus.c	2006-01-28 02:10:20 UTC (rev 227)
+++ branches/new-vsop-prepare/src/c/tests/validate_meeus.c	2006-01-28 02:12:11 UTC (rev 228)
@@ -70,7 +70,8 @@
 	printf(&quot;%s%sERROR:\n&quot;, tab, tab);
 	printf(&quot;%s%s%scomputed   = %.10f\n&quot;, tab, tab, tab, computed);
 	printf(&quot;%s%s%sreference  = %.10f\n&quot;, tab, tab, tab, reference);
-	printf(&quot;%s%s%sdifference = %.10f %s\n&quot;, tab, tab, tab, diff, units);
+	printf(&quot;%s%s%sdifference = %.10f %s\n&quot;, tab, tab, tab, diff,
+	       units);
     } else {
     }
 }
@@ -88,21 +89,22 @@
 			     double *longitude, double *latitude,
 			     double *radius)
 {
-  vsop_handle vh;
-  if(0 == get_vsop_data_handle(planet, hel_sph_date, &amp;vh)) {
-    vsop_sph_coords vsc = vsop_get_spherical(vh, jd);
-    if(vsc.error_state != 0) {
-      printf(&quot;Error calculating spherical coordinates: %d\n&quot;, vsc.error_state);
-      return 0;
+    vsop_handle vh;
+    if (0 == get_vsop_data_handle(planet, hel_sph_date, &amp;vh)) {
+	vsop_sph_coords vsc = vsop_get_spherical(vh, jd);
+	if (vsc.error_state != 0) {
+	    printf(&quot;Error calculating spherical coordinates: %d\n&quot;,
+		   vsc.error_state);
+	    return 0;
+	}
+	*longitude = vsc.sc.L;
+	*latitude = vsc.sc.B;
+	*radius = vsc.sc.R;
+	return 1;
+    } else {
+	printf(&quot;Unable to allocate the VSOP handle.\n&quot;);
+	return 0;
     }
-    *longitude = vsc.sc.L;
-    *latitude = vsc.sc.B;
-    *radius = vsc.sc.R;
-    return 1;
-  } else {
-    printf(&quot;Unable to allocate the VSOP handle.\n&quot;);
-    return 0;
-  }
 }
 
 int vsop_dimension3_fk5_new(double jd,
@@ -110,21 +112,23 @@
 			    double *longitude, double *latitude,
 			    double *radius)
 {
-  vsop_handle vh;
-  if(0 == get_vsop_data_handle(planet, hel_sph_date, &amp;vh)) {
-    vsop_sph_coords vsc = vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
-    if(vsc.error_state != 0) {
-      printf(&quot;Error calculating spherical coordinates: %d\n&quot;, vsc.error_state);
-      return 0;
+    vsop_handle vh;
+    if (0 == get_vsop_data_handle(planet, hel_sph_date, &amp;vh)) {
+	vsop_sph_coords vsc =
+	    vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
+	if (vsc.error_state != 0) {
+	    printf(&quot;Error calculating spherical coordinates: %d\n&quot;,
+		   vsc.error_state);
+	    return 0;
+	}
+	*longitude = vsc.sc.L;
+	*latitude = vsc.sc.B;
+	*radius = vsc.sc.R;
+	return 1;
+    } else {
+	printf(&quot;Unable to allocate the VSOP handle.\n&quot;);
+	return 0;
     }
-    *longitude = vsc.sc.L;
-    *latitude = vsc.sc.B;
-    *radius = vsc.sc.R;
-    return 1;
-  } else {
-    printf(&quot;Unable to allocate the VSOP handle.\n&quot;);
-    return 0;
-  }
 }
 
 /*
@@ -596,7 +600,8 @@
 		   dms_to_d(0.0, 0.0, 0.0895) * 28.86705);
 	double a1;
 	double d1;
-	precession_eq(precession_get_elements_eq(2451545.0, 2462088.69), a0, d0, &amp;a1, &amp;d1);
+	precession_eq(precession_get_elements_eq(2451545.0, 2462088.69),
+		      a0, d0, &amp;a1, &amp;d1);
 
 	report(&quot;RA&quot;, a1, fday_to_r(hms_to_fday(2, 46, 11.331)), 0.00001,
 	       &quot;radians&quot;);
@@ -609,7 +614,9 @@
 	double lat = d_to_r(1.76549);
 	double lon1;
 	double lat1;
-	precession_ecl(precession_get_elements_ecl(je_to_jd(2000.0), 1643074.5), lon, lat, &amp;lon1, &amp;lat1);
+	precession_ecl(precession_get_elements_ecl
+		       (je_to_jd(2000.0), 1643074.5), lon, lat, &amp;lon1,
+		       &amp;lat1);
 	report(&quot;Longitude&quot;, lon1, d_to_r(118.704), 0.00001, &quot;radians&quot;);
 	report(&quot;Latitude&quot;, lat1, d_to_r(1.615), 0.0001, &quot;radians&quot;);
     }
@@ -658,59 +665,68 @@
 
     printf(&quot;23.a Apparent place of a star\n&quot;);
     {
-      double jd = ut_to_dt(cal_to_jd(2028, 11, 13.19, true));
-      double ra = hms_to_r(2,46,11.331);
-      double dec = d_to_r(dms_to_d(49,20,54.54));
+	double jd = ut_to_dt(cal_to_jd(2028, 11, 13.19, true));
+	double ra = hms_to_r(2, 46, 11.331);
+	double dec = d_to_r(dms_to_d(49, 20, 54.54));
 
-      double n_in_l = nut_in_lon(jd);
-      /*
-	d_to_r(dms_to_d(0,0,14.861));
-      */
+	double n_in_l = nut_in_lon(jd);
+	/*
+	   d_to_r(dms_to_d(0,0,14.861));
+	 */
 
-      double n_in_o = nut_in_obl(jd);
-      /*
-	d_to_r(dms_to_d(0,0,2.705));
-      */
+	double n_in_o = nut_in_obl(jd);
+	/*
+	   d_to_r(dms_to_d(0,0,2.705));
+	 */
 
-      double obl = obliquity_hi(jd);
-      /*
-	d_to_r(23.436);
-      */
+	double obl = obliquity_hi(jd);
+	/*
+	   d_to_r(23.436);
+	 */
 
-      double sol_lon, sol_rad;
-      longitude_radius_low(jd, &amp;sol_lon, &amp;sol_rad);
-      /*
-      sol_lon = d_to_r(231.328);
-      */
+	double sol_lon, sol_rad;
+	longitude_radius_low(jd, &amp;sol_lon, &amp;sol_rad);
+	/*
+	   sol_lon = d_to_r(231.328);
+	 */
 
-      double n_in_ra, n_in_dec;
-      nut_in_ra_dec(ra, dec, obl, n_in_l, n_in_o, &amp;n_in_ra, &amp;n_in_dec);
+	double n_in_ra, n_in_dec;
+	nut_in_ra_dec(ra, dec, obl, n_in_l, n_in_o, &amp;n_in_ra, &amp;n_in_dec);
 
-      double a_in_ra, a_in_dec;
-      aberration_in_ra_dec_low(jd, ra, dec, obl, sol_lon, &amp;a_in_ra, &amp;a_in_dec);
+	double a_in_ra, a_in_dec;
+	aberration_in_ra_dec_low(jd, ra, dec, obl, sol_lon, &amp;a_in_ra,
+				 &amp;a_in_dec);
 
-      /*
-      int d1, m1, d2, m2;
-      double s1, s2;
-      d_to_dms(r_to_d(n_in_ra), &amp;d1, &amp;m1, &amp;s1);
-      d_to_dms(r_to_d(n_in_dec), &amp;d2, &amp;m2, &amp;s2);
-      printf(&quot;%d:%d:%.10f$$$%d:%d:%.10f\n&quot;, d1,m1,s1,d2,m2,s2);
-      */
+	/*
+	   int d1, m1, d2, m2;
+	   double s1, s2;
+	   d_to_dms(r_to_d(n_in_ra), &amp;d1, &amp;m1, &amp;s1);
+	   d_to_dms(r_to_d(n_in_dec), &amp;d2, &amp;m2, &amp;s2);
+	   printf(&quot;%d:%d:%.10f$$$%d:%d:%.10f\n&quot;, d1,m1,s1,d2,m2,s2);
+	 */
 
-      report(&quot;nutation in longitude&quot;, n_in_l, d_to_r(dms_to_d(0,0,14.861)), 0.000001, &quot;radians&quot;);
-      report(&quot;nutation in obliquity&quot;, n_in_o, d_to_r(dms_to_d(0,0,2.705)), 0.000001, &quot;radians&quot;);
-      report(&quot;obliquity&quot;, obl, d_to_r(23.436), 0.0001, &quot;radians&quot;);
-      report(&quot;sun's true longitude&quot;, sol_lon, d_to_r(231.328), 0.0001, &quot;radians&quot;);
-      report(&quot;nutation in ra&quot;, n_in_ra, d_to_r(dms_to_d(0,0,15.843)), 0.000001, &quot;radians&quot;);
-      report(&quot;nutation in dec&quot;, n_in_dec, d_to_r(dms_to_d(0,0,6.218)), 0.000001, &quot;radians&quot;);
-      report(&quot;aberration in ra&quot;, a_in_ra, d_to_r(dms_to_d(0,0,30.045)), 0.000001, &quot;radians&quot;);
-      report(&quot;aberration in dec&quot;, a_in_dec, d_to_r(dms_to_d(0,0,6.697)), 0.000001, &quot;radians&quot;);
+	report(&quot;nutation in longitude&quot;, n_in_l,
+	       d_to_r(dms_to_d(0, 0, 14.861)), 0.000001, &quot;radians&quot;);
+	report(&quot;nutation in obliquity&quot;, n_in_o,
+	       d_to_r(dms_to_d(0, 0, 2.705)), 0.000001, &quot;radians&quot;);
+	report(&quot;obliquity&quot;, obl, d_to_r(23.436), 0.0001, &quot;radians&quot;);
+	report(&quot;sun's true longitude&quot;, sol_lon, d_to_r(231.328), 0.0001,
+	       &quot;radians&quot;);
+	report(&quot;nutation in ra&quot;, n_in_ra, d_to_r(dms_to_d(0, 0, 15.843)),
+	       0.000001, &quot;radians&quot;);
+	report(&quot;nutation in dec&quot;, n_in_dec, d_to_r(dms_to_d(0, 0, 6.218)),
+	       0.000001, &quot;radians&quot;);
+	report(&quot;aberration in ra&quot;, a_in_ra, d_to_r(dms_to_d(0, 0, 30.045)),
+	       0.000001, &quot;radians&quot;);
+	report(&quot;aberration in dec&quot;, a_in_dec,
+	       d_to_r(dms_to_d(0, 0, 6.697)), 0.000001, &quot;radians&quot;);
 
-      double new_ra = ra + n_in_ra + a_in_ra;
-      double new_dec = dec + n_in_dec + a_in_dec;
+	double new_ra = ra + n_in_ra + a_in_ra;
+	double new_dec = dec + n_in_dec + a_in_dec;
 
-      report(&quot;ra&quot;, new_ra, hms_to_r(2, 46, 14.390), 0.000001, &quot;radians&quot;);
-      report(&quot;dec&quot;, new_dec, d_to_r(dms_to_d(49, 21, 07.45)), 0.000001, &quot;radians&quot;);
+	report(&quot;ra&quot;, new_ra, hms_to_r(2, 46, 14.390), 0.000001, &quot;radians&quot;);
+	report(&quot;dec&quot;, new_dec, d_to_r(dms_to_d(49, 21, 07.45)), 0.000001,
+	       &quot;radians&quot;);
 
     }
 
@@ -726,33 +742,37 @@
 
     printf(&quot;25.b Sun position, high precision\n&quot;);
     {
-        double jd = 2448908.5;
+	double jd = 2448908.5;
 	double L, B, R;
 	sol_dimension3_vsop(jd, &amp;L, &amp;B, &amp;R);
 	/*
-	report_diff(&quot;longitude&quot;, r_to_d(L) * 3600, 199.907372 * 3600,
-		    &quot;arc-seconds&quot;);
-	report_diff(&quot;latitude&quot;, r_to_d(B) * 3600, 0.644, &quot;arc-seconds&quot;);
-	report_diff(&quot;radius&quot;, R * km_per_au, 0.99760775 * km_per_au, &quot;km&quot;);
-	*/
+	   report_diff(&quot;longitude&quot;, r_to_d(L) * 3600, 199.907372 * 3600,
+	   &quot;arc-seconds&quot;);
+	   report_diff(&quot;latitude&quot;, r_to_d(B) * 3600, 0.644, &quot;arc-seconds&quot;);
+	   report_diff(&quot;radius&quot;, R * km_per_au, 0.99760775 * km_per_au, &quot;km&quot;);
+	 */
 
-	report(&quot;longitude&quot;, r_to_d(L) * 3600, 199.907372 * 3600, 1.0, &quot;arc-seconds&quot;);
+	report(&quot;longitude&quot;, r_to_d(L) * 3600, 199.907372 * 3600, 1.0,
+	       &quot;arc-seconds&quot;);
 	report(&quot;latitude&quot;, r_to_d(B) * 3600, 0.644, 1.0, &quot;arc-seconds&quot;);
-	report(&quot;radius&quot;, R * km_per_au, 0.99760775 * km_per_au, 200.0, &quot;km&quot;);
+	report(&quot;radius&quot;, R * km_per_au, 0.99760775 * km_per_au, 200.0,
+	       &quot;km&quot;);
 
 	vsop_to_fk5(2448908.5, &amp;L, &amp;B);
 
 	/*
-	report_diff(&quot;corrected longitude&quot;, r_to_d(L) * 3600,
-		    199.907347 * 3600, &quot;arc-seconds&quot;);
-	report_diff(&quot;corrected latitude&quot;, r_to_d(B) * 3600, 0.62,
-		    &quot;arc-seconds&quot;);
-	*/
-	report(&quot;corrected fk5 longitude&quot;, r_to_d(L) * 3600, 199.907347 * 3600, 1.0, &quot;arc-seconds&quot;);
-	report(&quot;corrected fk5 latitude&quot;, r_to_d(B) * 3600, 0.644 - 0.023, 0.1, &quot;arc-seconds&quot;);
+	   report_diff(&quot;corrected longitude&quot;, r_to_d(L) * 3600,
+	   199.907347 * 3600, &quot;arc-seconds&quot;);
+	   report_diff(&quot;corrected latitude&quot;, r_to_d(B) * 3600, 0.62,
+	   &quot;arc-seconds&quot;);
+	 */
+	report(&quot;corrected fk5 longitude&quot;, r_to_d(L) * 3600,
+	       199.907347 * 3600, 1.0, &quot;arc-seconds&quot;);
+	report(&quot;corrected fk5 latitude&quot;, r_to_d(B) * 3600, 0.644 - 0.023,
+	       0.1, &quot;arc-seconds&quot;);
 	/*
-	report(&quot;corrected fk5 latitude&quot;, r_to_d(B) * 3600, 0.62, 0.1, &quot;arc-seconds&quot;);
-	*/
+	   report(&quot;corrected fk5 latitude&quot;, r_to_d(B) * 3600, 0.62, 0.1, &quot;arc-seconds&quot;);
+	 */
 
 	printf
 	    (&quot;25.b Sun position, high precision (complete theory pg 165)\n&quot;);
@@ -762,15 +782,17 @@
 	const double obl = obliquity_hi(jd) + n_in_o;
 	const double aberration = aberration_low(R);
 
-	report(&quot;nutation in lon&quot;, r_to_d(n_in_l) * 3600, 15.908, 0.001, &quot;arc-seconds&quot;);
-	report(&quot;nutation in obliquity&quot;, r_to_d(n_in_o) * 3600, -0.308, 0.001, &quot;arc-seconds&quot;);
+	report(&quot;nutation in lon&quot;, r_to_d(n_in_l) * 3600, 15.908, 0.001,
+	       &quot;arc-seconds&quot;);
+	report(&quot;nutation in obliquity&quot;, r_to_d(n_in_o) * 3600, -0.308,
+	       0.001, &quot;arc-seconds&quot;);
 	report(&quot;obliquity&quot;, r_to_d(obl), 23.4401443, 0.0000001, &quot;degrees&quot;);
-	report(&quot;aberration&quot;, r_to_d(aberration) * 3600, -20.539, 0.001, &quot;arc-seconds&quot;);
+	report(&quot;aberration&quot;, r_to_d(aberration) * 3600, -20.539, 0.001,
+	       &quot;arc-seconds&quot;);
 
 	double app_lon = L + n_in_l + aberration;
 	report(&quot;apparent longitude&quot;, r_to_d(app_lon) * 3600.0,
-	       dms_to_d(199, 54, 21.818) * 3600.0, 1,
-	       &quot;arc-seconds&quot;);
+	       dms_to_d(199, 54, 21.818) * 3600.0, 1, &quot;arc-seconds&quot;);
 
 	report(&quot;longitude&quot;, r_to_d(L) * 3600 * 100,
 	       dms_to_d(199, 54, 26.18) * 3600 * 100, 1,
@@ -805,16 +827,23 @@
 
 	vsop_handle vh;
 	int result;
-	if(0 != (result = get_vsop_data_handle(vsop_earth, hel_sph_date, &amp;vh))) {
-	  printf(&quot;Problem opening file: %s&quot;, strerror(result));
+	if (0 !=
+	    (result =
+	     get_vsop_data_handle(vsop_earth, hel_sph_date, &amp;vh))) {
+	    printf(&quot;Problem opening file: %s&quot;, strerror(result));
 	} else {
-	  vsop_sph_coords vsc = vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
+	    vsop_sph_coords vsc =
+		vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
 
-	  double E = obliquity_hi(jd);
-	  rec_coords rc = sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
-	  report(&quot;X&quot;, -rc.x * km_per_au, -0.9379952 * km_per_au, 5.0, &quot;km&quot;);
-	  report(&quot;Y&quot;, -rc.y * km_per_au, -0.3116544 * km_per_au, 5.0, &quot;km&quot;);
-	  report(&quot;Z&quot;, -rc.z * km_per_au, -0.1351215 * km_per_au, 5.0, &quot;km&quot;);
+	    double E = obliquity_hi(jd);
+	    rec_coords rc =
+		sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
+	    report(&quot;X&quot;, -rc.x * km_per_au, -0.9379952 * km_per_au, 5.0,
+		   &quot;km&quot;);
+	    report(&quot;Y&quot;, -rc.y * km_per_au, -0.3116544 * km_per_au, 5.0,
+		   &quot;km&quot;);
+	    report(&quot;Z&quot;, -rc.z * km_per_au, -0.1351215 * km_per_au, 5.0,
+		   &quot;km&quot;);
 
 	}
 
@@ -828,9 +857,9 @@
 /* 	  report(&quot;X&quot;, -vrc.rc.x * km_per_au, -0.9379952 * km_per_au, 5.0, &quot;km&quot;); */
 /* 	  report(&quot;Y&quot;, -vrc.rc.y * km_per_au, -0.3116544 * km_per_au, 5.0, &quot;km&quot;); */
 /* 	  report(&quot;Z&quot;, -vrc.rc.z * km_per_au, -0.1351215 * km_per_au, 5.0, &quot;km&quot;); */
-	  
+
 /* 	} */
- 
+
     }
 
     printf(&quot;27.a Approximate solstice\n&quot;);
@@ -924,7 +953,7 @@
 
     printf(&quot;28.a Equation of time\n&quot;);
     {
-      double jd = 2448908.5;
+	double jd = 2448908.5;
 	double eot_result = equation_of_time(jd);
 	report(&quot;Equation of time&quot;, eot_result * 3600.0,
 	       fday_to_r(hms_to_fday(0.0, 13.0, 42.6)) * 3600.0, 1,
@@ -944,14 +973,15 @@
     {
 	double L, B, R;
 	/*
-	vsop_dimension3_vsop(2448976.5, vVenus, &amp;L, &amp;B, &amp;R);
-	*/
-	if(vsop_dimension3_vsop_new(2448976.5, vsop_venus, &amp;L, &amp;B, &amp;R)) {
-	  report(&quot;longitude&quot;, r_to_d(L), 26.11428, 1.0, &quot;deg&quot;);
-	  report(&quot;latitude&quot;, r_to_d(B), -2.62070, 1.0, &quot;deg&quot;);
-	  report(&quot;radius&quot;, R * km_per_au, 0.724603 * km_per_au, 200.0, &quot;km&quot;);
+	   vsop_dimension3_vsop(2448976.5, vVenus, &amp;L, &amp;B, &amp;R);
+	 */
+	if (vsop_dimension3_vsop_new(2448976.5, vsop_venus, &amp;L, &amp;B, &amp;R)) {
+	    report(&quot;longitude&quot;, r_to_d(L), 26.11428, 1.0, &quot;deg&quot;);
+	    report(&quot;latitude&quot;, r_to_d(B), -2.62070, 1.0, &quot;deg&quot;);
+	    report(&quot;radius&quot;, R * km_per_au, 0.724603 * km_per_au, 200.0,
+		   &quot;km&quot;);
 	} else {
-	  printf(&quot;There was a problem with the VSOP code or data.\n&quot;);
+	    printf(&quot;There was a problem with the VSOP code or data.\n&quot;);
 	}
     }
 
@@ -959,13 +989,14 @@
     {
 	double ra, dec;
 	/*
-	geocentric_planet(2448976.5, vEarth, vVenus, vsop_dimension3_fk5,
+	   geocentric_planet(2448976.5, vEarth, vVenus, vsop_dimension3_fk5,
+	   d_to_r(dms_to_d(0, 0, 16.749)),
+	   d_to_r(23.439669), days_per_second, &amp;ra, &amp;dec);
+	 */
+	geocentric_planet(2448976.5, vsop_earth, vsop_venus,
+			  vsop_dimension3_fk5_new,
 			  d_to_r(dms_to_d(0, 0, 16.749)),
 			  d_to_r(23.439669), days_per_second, &amp;ra, &amp;dec);
-	*/
-	geocentric_planet(2448976.5, vsop_earth, vsop_venus, vsop_dimension3_fk5_new,
-			  d_to_r(dms_to_d(0, 0, 16.749)),
-			  d_to_r(23.439669), days_per_second, &amp;ra, &amp;dec);
 
 	report(&quot;ra&quot;, r_to_d(ra), r_to_d(hms_to_fday(21, 4, 41.454) * pi2),
 	       1e-5, &quot;degrees&quot;);
@@ -999,51 +1030,63 @@
 
 	vsop_handle vh;
 	int result;
-	if(0 != (result = get_vsop_data_handle(vsop_earth, hel_sph_j2, &amp;vh))) {
-	  printf(&quot;Problem opening file: %s&quot;, strerror(result));
+	if (0 !=
+	    (result = get_vsop_data_handle(vsop_earth, hel_sph_j2, &amp;vh))) {
+	    printf(&quot;Problem opening file: %s&quot;, strerror(result));
 	} else {
-	  vsop_sph_coords vsc = vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
+	    vsop_sph_coords vsc =
+		vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, jd));
 
-	  double E = obliquity_hi(jd);
-	  rec_coords src = sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
-	  src.x = -src.x;
-	  src.y = -src.y;
-	  src.z = -src.z;
+	    double E = obliquity_hi(jd);
+	    rec_coords src =
+		sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
+	    src.x = -src.x;
+	    src.y = -src.y;
+	    src.z = -src.z;
 
 /* 	double L, B, R; */
 /* 	sol_dimension3_fk5(jd, &amp;L, &amp;B, &amp;R); */
 /* 	rec_coords src = sol_rectangular(L, B, R, obl2000); */
-	  report(&quot;solar x&quot;, src.x * km_per_au, -0.9756732 * km_per_au, 800, &quot;km&quot;);
-	  report(&quot;solar y&quot;, src.y * km_per_au, -0.2003254 * km_per_au, 800, &quot;km&quot;);
-	  report(&quot;solar z&quot;, src.z * km_per_au, -0.0868566 * km_per_au, 800, &quot;km&quot;);
+	    report(&quot;solar x&quot;, src.x * km_per_au, -0.9756732 * km_per_au,
+		   800, &quot;km&quot;);
+	    report(&quot;solar y&quot;, src.y * km_per_au, -0.2003254 * km_per_au,
+		   800, &quot;km&quot;);
+	    report(&quot;solar z&quot;, src.z * km_per_au, -0.0868566 * km_per_au,
+		   800, &quot;km&quot;);
 
 /* 	printf(&quot;Resetting sol values to those in example (because VSOP isn't calculating them properly as above)\n&quot;); */
 /* 	src.x = -0.9756732; */
 /* 	src.y = -0.2003254; */
 /* 	src.z = -0.0868566; */
 
-	  double ra, dec, elongation, phase_angle, body_r_earth;
-	  elliptical_orbit_ecliptical(src, rc, r_sun, &amp;ra, &amp;dec, &amp;elongation, &amp;phase_angle, &amp;body_r_earth);
+	    double ra, dec, elongation, phase_angle, body_r_earth;
+	    elliptical_orbit_ecliptical(src, rc, r_sun, &amp;ra, &amp;dec,
+					&amp;elongation, &amp;phase_angle,
+					&amp;body_r_earth);
 
-	  report(&quot;delta-earth&quot;, body_r_earth, 0.8243689, 0.000001, &quot;AU&quot;);
+	    report(&quot;delta-earth&quot;, body_r_earth, 0.8243689, 0.000001, &quot;AU&quot;);
 
-	  double tau = 0.0057755183 * body_r_earth;
-	  jd = jd - tau;
-	  el.M = mean_anomoly(jd, T, el.n);
-	  ec = get_element_constants(obl2000, el, 53);
-	  r_sun = get_r_sun(ec);
-	  rc = elliptical_orbit_rectangular(ec, r_sun);
+	    double tau = 0.0057755183 * body_r_earth;
+	    jd = jd - tau;
+	    el.M = mean_anomoly(jd, T, el.n);
+	    ec = get_element_constants(obl2000, el, 53);
+	    r_sun = get_r_sun(ec);
+	    rc = elliptical_orbit_rectangular(ec, r_sun);
 
-	  report(&quot;recalc-x&quot;, rc.x, 0.2509310, 0.000001, &quot;AU&quot;);
-	  report(&quot;recalc-y&quot;, rc.y, 0.4849477, 0.000001, &quot;AU&quot;);
-	  report(&quot;recalc-z&quot;, rc.z, 0.3573712, 0.000001, &quot;AU&quot;);
+	    report(&quot;recalc-x&quot;, rc.x, 0.2509310, 0.000001, &quot;AU&quot;);
+	    report(&quot;recalc-y&quot;, rc.y, 0.4849477, 0.000001, &quot;AU&quot;);
+	    report(&quot;recalc-z&quot;, rc.z, 0.3573712, 0.000001, &quot;AU&quot;);
 
-	  elliptical_orbit_ecliptical(src, rc, r_sun, &amp;ra, &amp;dec, &amp;elongation, &amp;phase_angle, &amp;body_r_earth);
+	    elliptical_orbit_ecliptical(src, rc, r_sun, &amp;ra, &amp;dec,
+					&amp;elongation, &amp;phase_angle,
+					&amp;body_r_earth);
 
-	  report(&quot;recalc-delta-earth&quot;, body_r_earth, 0.8242811, 0.000001, &quot;AU&quot;);
-	  report(&quot;ra&quot;, ra, d_to_r(158.558965), 0.00001, &quot;radians&quot;);
-	  report(&quot;dec&quot;, dec, d_to_r(19.158496), 0.00001, &quot;radians&quot;);
-	  report(&quot;elongation&quot;, elongation, d_to_r(40.51), 0.00001, &quot;radians&quot;);
+	    report(&quot;recalc-delta-earth&quot;, body_r_earth, 0.8242811, 0.000001,
+		   &quot;AU&quot;);
+	    report(&quot;ra&quot;, ra, d_to_r(158.558965), 0.00001, &quot;radians&quot;);
+	    report(&quot;dec&quot;, dec, d_to_r(19.158496), 0.00001, &quot;radians&quot;);
+	    report(&quot;elongation&quot;, elongation, d_to_r(40.51), 0.00001,
+		   &quot;radians&quot;);
 	}
 
     }
@@ -1154,20 +1197,22 @@
 
 	    vsop_handle vh;
 	    get_vsop_data_handle(vsop_earth, hel_sph_j2, &amp;vh);
-	    vsop_sph_coords vsc = vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, test-&gt;jd));
+	    vsop_sph_coords vsc =
+		vsop_sph_vsop_to_fk5(vsop_get_spherical(vh, test-&gt;jd));
 
 	    double E = obliquity_hi(test-&gt;jd);
 	    vsc.sc.L = modpi2(vsc.sc.L + pi);
 	    vsc.sc.B = -vsc.sc.B;
-	    rec_coords sun_rec = sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
+	    rec_coords sun_rec =
+		sol_rectangular(vsc.sc.L, vsc.sc.B, vsc.sc.R, E);
 
 
 
 	    /*
-	    double L, B, R;
-	    sol_dimension3_fk5(test-&gt;jd, &amp;L, &amp;B, &amp;R);
-	    rec_coords sun_rec = sol_rectangular(L, B, R, obliquity_hi(je_to_jd(2000)));
-	    */
+	       double L, B, R;
+	       sol_dimension3_fk5(test-&gt;jd, &amp;L, &amp;B, &amp;R);
+	       rec_coords sun_rec = sol_rectangular(L, B, R, obliquity_hi(je_to_jd(2000)));
+	     */
 
 	    double ra;
 	    double dec;
@@ -1179,22 +1224,26 @@
 
 	    double this_jd = test-&gt;jd;
 	    int c;
-	    for(c=0;c&lt;5;c++) {
-	      cd = populate_orbital_elements(or-&gt;epoch, or-&gt;M, this_jd, or-&gt;n,
-					     or-&gt;a, or-&gt;e, or-&gt;i, or-&gt;w, or-&gt;L,
-					     iau_s, or-&gt;H, or-&gt;G);
+	    for (c = 0; c &lt; 5; c++) {
+		cd = populate_orbital_elements(or-&gt;epoch, or-&gt;M, this_jd,
+					       or-&gt;n, or-&gt;a, or-&gt;e, or-&gt;i,
+					       or-&gt;w, or-&gt;L, iau_s, or-&gt;H,
+					       or-&gt;G);
 
-	      element_constants ec = get_element_constants(obliquity_hi(je_to_jd(2000)), cd, 53);
-	      body_r_sun = get_r_sun(ec);
-	      rec_coords body_rec = elliptical_orbit_rectangular(ec, body_r_sun);
+		element_constants ec =
+		    get_element_constants(obliquity_hi(je_to_jd(2000)), cd,
+					  53);
+		body_r_sun = get_r_sun(ec);
+		rec_coords body_rec =
+		    elliptical_orbit_rectangular(ec, body_r_sun);
 
-	      elliptical_orbit_ecliptical(sun_rec, body_rec, body_r_sun,
-					  &amp;ra, &amp;dec, &amp;elongation,
-					  &amp;phase_angle, &amp;body_r_earth);
+		elliptical_orbit_ecliptical(sun_rec, body_rec, body_r_sun,
+					    &amp;ra, &amp;dec, &amp;elongation,
+					    &amp;phase_angle, &amp;body_r_earth);
 
-	      double tau = 0.0057755183 * body_r_earth;
+		double tau = 0.0057755183 * body_r_earth;
 
-	      this_jd = test-&gt;jd - tau;
+		this_jd = test-&gt;jd - tau;
 
 	    }
 
@@ -1217,26 +1266,40 @@
 
 	    /* Adjust for nutation. */
 	    double a_in_ra, a_in_dec;
-	    aberration_in_ra_dec_low(test-&gt;jd, ra, dec, obliquity_hi(test-&gt;jd), vsc.sc.L, &amp;a_in_ra, &amp;a_in_dec);
-	    ra  += a_in_ra;
+	    aberration_in_ra_dec_low(test-&gt;jd, ra, dec,
+				     obliquity_hi(test-&gt;jd), vsc.sc.L,
+				     &amp;a_in_ra, &amp;a_in_dec);
+	    ra += a_in_ra;
 	    dec += a_in_dec;
 
-	    precession_eq(precession_get_elements_eq(je_to_jd(2000.0), test-&gt;jd), ra, dec, &amp;ra, &amp;dec);
+	    precession_eq(precession_get_elements_eq
+			  (je_to_jd(2000.0), test-&gt;jd), ra, dec, &amp;ra,
+			  &amp;dec);
 
 	    double n_in_ra, n_in_dec;
-	    nut_in_ra_dec(ra, dec, obliquity_hi(test-&gt;jd), nut_in_lon(test-&gt;jd), nut_in_obl(test-&gt;jd), &amp;n_in_ra, &amp;n_in_dec);
-	    ra  += n_in_ra ;
+	    nut_in_ra_dec(ra, dec, obliquity_hi(test-&gt;jd),
+			  nut_in_lon(test-&gt;jd), nut_in_obl(test-&gt;jd),
+			  &amp;n_in_ra, &amp;n_in_dec);
+	    ra += n_in_ra;
 	    dec += n_in_dec;
 
 
 
-	    printf(&quot;$$$$ %f:%f $$$$\n&quot;, (n_in_ra * (360.0 * 60.0 * 60.0) / (2*pi)), (n_in_dec * (360.0 * 60.0 * 60.0) / (2*pi)));
-	    printf(&quot;$$$$ %f:%f $$$$\n&quot;, (a_in_ra * (360.0 * 60.0 * 60.0) / (2*pi)), (a_in_dec * (360.0 * 60.0 * 60.0) / (2*pi)));
+	    printf(&quot;$$$$ %f:%f $$$$\n&quot;,
+		   (n_in_ra * (360.0 * 60.0 * 60.0) / (2 * pi)),
+		   (n_in_dec * (360.0 * 60.0 * 60.0) / (2 * pi)));
+	    printf(&quot;$$$$ %f:%f $$$$\n&quot;,
+		   (a_in_ra * (360.0 * 60.0 * 60.0) / (2 * pi)),
+		   (a_in_dec * (360.0 * 60.0 * 60.0) / (2 * pi)));
 
-	    report(&quot;RA&quot;, (ra * (360.0 * 60.0 * 60.0) / (2*pi)), (test-&gt;ra * (360.0 * 60.0 * 60.0) / (2*pi)), 0.00030, &quot;arc-sec&quot;);
-	    report(&quot;Declination&quot;, (dec * (360.0 * 60.0 * 60.0) / (2*pi)), (test-&gt;dec * (360.0 * 60.0 * 60.0) / (2*pi)), 0.00030, &quot;arc-sec&quot;);
-	    report(&quot;Distance (Earth)&quot;, body_r_earth, test-&gt;r_earth, 0.000001,
-		   &quot;AU&quot;);
+	    report(&quot;RA&quot;, (ra * (360.0 * 60.0 * 60.0) / (2 * pi)),
+		   (test-&gt;ra * (360.0 * 60.0 * 60.0) / (2 * pi)), 0.00030,
+		   &quot;arc-sec&quot;);
+	    report(&quot;Declination&quot;, (dec * (360.0 * 60.0 * 60.0) / (2 * pi)),
+		   (test-&gt;dec * (360.0 * 60.0 * 60.0) / (2 * pi)), 0.00030,
+		   &quot;arc-sec&quot;);
+	    report(&quot;Distance (Earth)&quot;, body_r_earth, test-&gt;r_earth,
+		   0.000001, &quot;AU&quot;);
 	    report(&quot;Distance (Sun)&quot;, body_r_sun, test-&gt;r_sun, 0.000001,
 		   &quot;AU&quot;);
 	    report(&quot;Magnitude&quot;, mag, test-&gt;mag, 1.0, &quot;&quot;);
@@ -1270,19 +1333,22 @@
     {
 	printf(&quot;Checking new VSOP routines\n&quot;);
 	{
-	  vsop_handle vh;
+	    vsop_handle vh;
 
- 	  if(0 != get_vsop_data_handle(vsop_earth, hel_rec_j2, &amp;vh)) {
-	    printf(&quot;\t\tError loading Earth handle.\n&quot;);
-	  } else {
-	    double jd = 2448170.5;
-	    vsop_rec_coords vrc = vsop_get_rectangular(vh, jd);
-	    vrc = vsop_rec_invert(vsop_rec_vsop_to_fk5(vrc));
+	    if (0 != get_vsop_data_handle(vsop_earth, hel_rec_j2, &amp;vh)) {
+		printf(&quot;\t\tError loading Earth handle.\n&quot;);
+	    } else {
+		double jd = 2448170.5;
+		vsop_rec_coords vrc = vsop_get_rectangular(vh, jd);
+		vrc = vsop_rec_invert(vsop_rec_vsop_to_fk5(vrc));
 
-	    report(&quot;X&quot;, vrc.rc.x * km_per_au, -0.975673220683  * km_per_au, 1.0e-4, &quot;km&quot;);
-	    report(&quot;Y&quot;, vrc.rc.y * km_per_au, -0.200325394065  * km_per_au, 1.0e-4, &quot;km&quot;);
-	    report(&quot;Z&quot;, vrc.rc.z * km_per_au, -0.0868565820014 * km_per_au, 1.0e-4, &quot;km&quot;);
-	  }
+		report(&quot;X&quot;, vrc.rc.x * km_per_au,
+		       -0.975673220683 * km_per_au, 1.0e-4, &quot;km&quot;);
+		report(&quot;Y&quot;, vrc.rc.y * km_per_au,
+		       -0.200325394065 * km_per_au, 1.0e-4, &quot;km&quot;);
+		report(&quot;Z&quot;, vrc.rc.z * km_per_au,
+		       -0.0868565820014 * km_per_au, 1.0e-4, &quot;km&quot;);
+	    }
 	}
     }
 /* 	{ */
@@ -1315,13 +1381,13 @@
 
 int main(int argc, char *argv[])
 {
-  vsop_data_init();
-  _main();
-  vsop_data_cleanup();
+    vsop_data_init();
+    _main();
+    vsop_data_cleanup();
 
-  printf
-    (&quot;\nWarning: Former exception throws (now error return values)&quot;
-     &quot; have not been checked for.\n&quot;);
+    printf
+	(&quot;\nWarning: Former exception throws (now error return values)&quot;
+	 &quot; have not been checked for.\n&quot;);
     /*
        try {
        _main();
@@ -1330,5 +1396,5 @@
        cout &lt;&lt; e.what() &lt;&lt; endl;
        }
      */
-  return 0;
+    return 0;
 }

Modified: branches/new-vsop-prepare/src/c/utils/build_vsop_data.c
===================================================================
--- branches/new-vsop-prepare/src/c/utils/build_vsop_data.c	2006-01-28 02:10:20 UTC (rev 227)
+++ branches/new-vsop-prepare/src/c/utils/build_vsop_data.c	2006-01-28 02:12:11 UTC (rev 228)
@@ -42,13 +42,14 @@
 #define BUF_SIZE 1000
 
 
-static char *substr(char *target, char *src, const int start, const int end)
+static char *substr(char *target, char *src, const int start,
+		    const int end)
 {
-  char *t = target, *p;
-  for(p = src + start; p != src+end; p++)
-    *(t++) = *p;
-  *(t++) = '\0';
-  return target;
+    char *t = target, *p;
+    for (p = src + start; p != src + end; p++)
+	*(t++) = *p;
+    *(t++) = '\0';
+    return target;
 }
 
 
@@ -58,29 +59,30 @@
  */
 static char *strtrim(char *target, char *src)
 {
-  char *s = src, *t = target;
-  while(' ' == *s) s++;
-  do {
-    *t++ = *s;
-  } while('\0' != *s++);
-  int p;
-  for(p=strlen(target)-1; p&gt;=0 &amp;&amp; ' '==target[p]; p--) {
-    target[p] = '\0';
-  }
-  return target;
+    char *s = src, *t = target;
+    while (' ' == *s)
+	s++;
+    do {
+	*t++ = *s;
+    } while ('\0' != *s++);
+    int p;
+    for (p = strlen(target) - 1; p &gt;= 0 &amp;&amp; ' ' == target[p]; p--) {
+	target[p] = '\0';
+    }
+    return target;
 }
 
 
-static void fill_term(term_bin *t, char *incoming)
+static void fill_term(term_bin * t, char *incoming)
 {
-  char ch_A[32], ch_B[32], ch_C[32];
-  substr(ch_A, incoming,  79,  97);
-  substr(ch_B, incoming,  97, 111);
-  substr(ch_C, incoming, 111, 131);
+    char ch_A[32], ch_B[32], ch_C[32];
+    substr(ch_A, incoming, 79, 97);
+    substr(ch_B, incoming, 97, 111);
+    substr(ch_C, incoming, 111, 131);
 
-  t-&gt;A = atof(ch_A);
-  t-&gt;B = atof(ch_B);
-  t-&gt;C = atof(ch_C);
+    t-&gt;A = atof(ch_A);
+    t-&gt;B = atof(ch_B);
+    t-&gt;C = atof(ch_C);
 }
 
 
@@ -89,69 +91,82 @@
 /*! @brief Allocates space for and builds a body_elements structure in
  *  memory, given an opened file to read from.
  */
-static body_elements *build_body_elements(FILE *infile)
+static body_elements *build_body_elements(FILE * infile)
 {
-  /* Write the header at the start to force space.  It'll need
-   * overwriting at the end, as the data isn't available yet.
-   */
-  body_elements *body_el = (body_elements *)malloc(sizeof(body_elements));
-  memset(body_el, '\0', sizeof(*body_el));
-  sprintf(body_el-&gt;meta.eph_header_text, EPHEMERITIS_BIN_HEADER_TEXT_FORMAT, VERSION);
-  body_el-&gt;meta.num_variables = 0;
+    /* Write the header at the start to force space.  It'll need
+     * overwriting at the end, as the data isn't available yet.
+     */
+    body_elements *body_el =
+	(body_elements *) malloc(sizeof(body_elements));
+    memset(body_el, '\0', sizeof(*body_el));
+    sprintf(body_el-&gt;meta.eph_header_text,
+	    EPHEMERITIS_BIN_HEADER_TEXT_FORMAT, VERSION);
+    body_el-&gt;meta.num_variables = 0;
 
-  /* Allocate a reasonably sized buffer for reading lines into. */
-  char buf[BUF_SIZE];
+    /* Allocate a reasonably sized buffer for reading lines into. */
+    char buf[BUF_SIZE];
 
-  char *incoming;
-  char ch_body_name[8];
-  char ch_variable_num[2];
-  char ch_alpha[2];
-  char ch_num_terms[8];
+    char *incoming;
+    char ch_body_name[8];
+    char ch_variable_num[2];
+    char ch_alpha[2];
+    char ch_num_terms[8];
 
 
-  incoming = fgets(buf, BUF_SIZE, infile);
-  while(NULL != incoming) {
-    /* Extract some data. */
-    substr(ch_body_name, incoming, 22, 29);
-    substr(ch_variable_num, incoming, 41, 42);
-    substr(ch_alpha, incoming, 59, 60);
-    substr(ch_num_terms, incoming, 60, 67);
+    incoming = fgets(buf, BUF_SIZE, infile);
+    while (NULL != incoming) {
+	/* Extract some data. */
+	substr(ch_body_name, incoming, 22, 29);
+	substr(ch_variable_num, incoming, 41, 42);
+	substr(ch_alpha, incoming, 59, 60);
+	substr(ch_num_terms, incoming, 60, 67);
 
-    int variable_index = atoi(ch_variable_num) - 1;
-    int alpha = atoi(ch_alpha);
-    int num_terms = atoi(ch_num_terms);
+	int variable_index = atoi(ch_variable_num) - 1;
+	int alpha = atoi(ch_alpha);
+	int num_terms = atoi(ch_num_terms);
 
-    /* Copy in the name of the body (redundant all times except the first). */
-    strncpy(body_el-&gt;meta.body_name, strtrim(ch_body_name, ch_body_name), sizeof(body_el-&gt;meta.body_name));
+	/* Copy in the name of the body (redundant all times except the first). */
+	strncpy(body_el-&gt;meta.body_name,
+		strtrim(ch_body_name, ch_body_name),
+		sizeof(body_el-&gt;meta.body_name));
 
 
-    if(variable_index+1 &gt; body_el-&gt;meta.num_variables) {
-      body_el-&gt;meta.num_variables = variable_index+1;
-    }
+	if (variable_index + 1 &gt; body_el-&gt;meta.num_variables) {
+	    body_el-&gt;meta.num_variables = variable_index + 1;
+	}
 
 
-    /* This is a series header, so add a new series to the variable. */
-    body_el-&gt;variable_list[variable_index].meta.series_count++;
+	/* This is a series header, so add a new series to the variable. */
+	body_el-&gt;variable_list[variable_index].meta.series_count++;
 
 
-    body_el-&gt;variable_list[variable_index].series_list = (series *)realloc(body_el-&gt;variable_list[variable_index].series_list, sizeof(series) * body_el-&gt;variable_list[variable_index].meta.series_count);
+	body_el-&gt;variable_list[variable_index].series_list =
+	    (series *) realloc(body_el-&gt;variable_list[variable_index].
+			       series_list,
+			       sizeof(series) *
+			       body_el-&gt;variable_list[variable_index].meta.
+			       series_count);
 
-    series *this_series = &amp;(body_el-&gt;variable_list[variable_index].series_list[body_el-&gt;variable_list[variable_index].meta.series_count-1]);
-    this_series-&gt;meta.alpha = alpha;
-    this_series-&gt;meta.num_terms = num_terms;
-    this_series-&gt;terms = (term_bin *)calloc(num_terms, sizeof(term_bin));
+	series *this_series =
+	    &amp;(body_el-&gt;variable_list[variable_index].
+	      series_list[body_el-&gt;variable_list[variable_index].meta.
+			  series_count - 1]);
+	this_series-&gt;meta.alpha = alpha;
+	this_series-&gt;meta.num_terms = num_terms;
+	this_series-&gt;terms =
+	    (term_bin *) calloc(num_terms, sizeof(term_bin));
 
-    int n;
-    for(n = 0; n &lt; num_terms; n++) {
-      incoming = fgets(buf, BUF_SIZE, infile);
-      fill_term(&amp;(this_series-&gt;terms[n]), incoming);
+	int n;
+	for (n = 0; n &lt; num_terms; n++) {
+	    incoming = fgets(buf, BUF_SIZE, infile);
+	    fill_term(&amp;(this_series-&gt;terms[n]), incoming);
+	}
+
+	/* Read the next line. */
+	incoming = fgets(buf, BUF_SIZE, infile);
     }
 
-    /* Read the next line. */
-    incoming = fgets(buf, BUF_SIZE, infile);
-  }
-
-  return body_el;
+    return body_el;
 }
 
 /*! @brief Takes a source file and generate a binary file.
@@ -159,44 +174,45 @@
  *  @warning Any existing output files on the file system may be
  *  overwritten without warning.
  */
-static int process_streams(const char input_file[], const char output_file[])
+static int process_streams(const char input_file[],
+			   const char output_file[])
 {
-  FILE *infile, *outfile;
+    FILE *infile, *outfile;
 
-  /* Open files. */
-  if(!strcmp(input_file, &quot;-&quot;)) {
-    infile = stdin;
-  } else if(NULL == (infile = fopen(input_file, &quot;r&quot;))) {
-    fprintf(stderr, &quot;%s: %s\n&quot;, input_file, strerror(errno));
-    return 2;
-  }
+    /* Open files. */
+    if (!strcmp(input_file, &quot;-&quot;)) {
+	infile = stdin;
+    } else if (NULL == (infile = fopen(input_file, &quot;r&quot;))) {
+	fprintf(stderr, &quot;%s: %s\n&quot;, input_file, strerror(errno));
+	return 2;
+    }
 
-  if(!strcmp(output_file, &quot;-&quot;)) {
-    outfile = stdout;
-  } else if(NULL == (outfile = fopen(output_file, &quot;wb&quot;))) {
-    fclose(infile);
-    fprintf(stderr, &quot;%s: %s\n&quot;, output_file, strerror(errno));
-    return 3;
-  }
+    if (!strcmp(output_file, &quot;-&quot;)) {
+	outfile = stdout;
+    } else if (NULL == (outfile = fopen(output_file, &quot;wb&quot;))) {
+	fclose(infile);
+	fprintf(stderr, &quot;%s: %s\n&quot;, output_file, strerror(errno));
+	return 3;
+    }
 
-  body_elements *body_el = build_body_elements(infile);
+    body_elements *body_el = build_body_elements(infile);
 
-  /*
-  print_body_elements(stdout, body_el);
-  */
-  ephint_write_body_elements(outfile, body_el);
+    /*
+       print_body_elements(stdout, body_el);
+     */
+    ephint_write_body_elements(outfile, body_el);
 
-  ephint_free_body_elements(body_el);
+    ephint_free_body_elements(body_el);
 
-  /* Close files. */
-  if(infile != stdin) {
-    fclose(infile);
-  }
-  if((outfile != stdout) &amp;&amp; (outfile != stderr)) {
-    fclose(outfile);
-  }
+    /* Close files. */
+    if (infile != stdin) {
+	fclose(infile);
+    }
+    if ((outfile != stdout) &amp;&amp; (outfile != stderr)) {
+	fclose(outfile);
+    }
 
-  return 0;
+    return 0;
 }
 
 /*
@@ -217,17 +233,17 @@
 */
 int main(int argc, char *argv[])
 {
-  if(3 != argc) {
-    fprintf(stderr,
-	    &quot;Usage: build_vsop_data &lt;input_file&gt; &lt;output_file&gt;\n&quot;
-	    &quot;Specifying - for either file will respectively represent stdin and stdout.\n&quot;);
-    return 1;
-  }
-  char* input_file = argv[1];
-  char* output_file = argv[2];
-  int result = process_streams(input_file, output_file);
-  /*
-  check_data(output_file);
-  */
-  return result;
+    if (3 != argc) {
+	fprintf(stderr,
+		&quot;Usage: build_vsop_data &lt;input_file&gt; &lt;output_file&gt;\n&quot;
+		&quot;Specifying - for either file will respectively represent stdin and stdout.\n&quot;);
+	return 1;
+    }
+    char *input_file = argv[1];
+    char *output_file = argv[2];
+    int result = process_streams(input_file, output_file);
+    /*
+       check_data(output_file);
+     */
+    return result;
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000081.html">[Ephemeritis-svn] r227 - branches/new-vsop-prepare/src/c/libephemeritis
</A></li>
	<LI>Next message: <A HREF="000082.html">[Ephemeritis-svn] r229 - branches/new-vsop-prepare/src/c/libephemeritis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80">[ date ]</a>
              <a href="thread.html#80">[ thread ]</a>
              <a href="subject.html#80">[ subject ]</a>
              <a href="author.html#80">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/ephemeritis-svn">More information about the Ephemeritis-svn
mailing list</a><br>
</body></html>
